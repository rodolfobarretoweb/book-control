var express          = require('express'),
    load             = require('express-load'),
    i18n             = require('i18n'),
    cookieParser     = require('cookie-parser'),
    bodyParser       = require('body-parser'),
    expressValidator = require('express-validator'),
    app              = express();

/*
* ----------------------------------------------------------------------------------------------------------------------
* BODY PARSER
* ----------------------------------------------------------------------------------------------------------------------
*/
app.use(bodyParser.json());
app.use(bodyParser.urlencoded({ extended : true}));

/*
* ----------------------------------------------------------------------------------------------------------------------
* VALIDATOR
* ----------------------------------------------------------------------------------------------------------------------
*/
app.use(expressValidator());

/*
* ----------------------------------------------------------------------------------------------------------------------
* COOKIE
* ----------------------------------------------------------------------------------------------------------------------
*/
app.use(cookieParser());

/*
* ----------------------------------------------------------------------------------------------------------------------
* INTERNACIONALIZATION
* ----------------------------------------------------------------------------------------------------------------------
*/

i18n.configure({
  locales       : ['en', 'br'],
  directory     : __dirname + '/app/langs',
  defaultLocale : 'br',
  cookie        : 'current_language'
});

app.use(i18n.init);

/*
* ----------------------------------------------------------------------------------------------------------------------
* VIEWS
* ----------------------------------------------------------------------------------------------------------------------
*/
app.set('view engine', 'ejs');
app.set('views', __dirname + '/app/views');

/*
* ----------------------------------------------------------------------------------------------------------------------
* ASSETS
* ----------------------------------------------------------------------------------------------------------------------
*/
app.use(express.static(__dirname + '/assets'));

/*
* ----------------------------------------------------------------------------------------------------------------------
* AUTOLOAD
* ----------------------------------------------------------------------------------------------------------------------
*/
load('app/controllers').into(app);

/*
* ----------------------------------------------------------------------------------------------------------------------
* PORT
* ----------------------------------------------------------------------------------------------------------------------
*/
app.listen(3000);
